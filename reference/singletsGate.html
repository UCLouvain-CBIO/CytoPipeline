<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clean doublet events from flow cytometry data — singletsGate • CytoPipeline</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clean doublet events from flow cytometry data — singletsGate"><meta name="description" content="will adjust a polygon gate aimed at cleaning doublet events
from the flowFrame.
The main idea is to use the ratio between the two indicated channel as an
indicator and select only the events for which this ratio is 'not too far'
from the median ratio. More specifically, the computed ratio is ch1/(1+ch2).
However, instead of looking at a constant range of this ratio, as is done in
PeacoQC::removeDoublets(), which leads to a semi-conic gate,
we apply a parallelogram shaped gate, by keeping a constant range of channel
2 intensity, based on the target ratio range at the mid value of channel 1."><meta property="og:description" content="will adjust a polygon gate aimed at cleaning doublet events
from the flowFrame.
The main idea is to use the ratio between the two indicated channel as an
indicator and select only the events for which this ratio is 'not too far'
from the median ratio. More specifically, the computed ratio is ch1/(1+ch2).
However, instead of looking at a constant range of this ratio, as is done in
PeacoQC::removeDoublets(), which leads to a semi-conic gate,
we apply a parallelogram shaped gate, by keeping a constant range of channel
2 intensity, based on the target ratio range at the mid value of channel 1."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytoPipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CytoPipeline.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Demo.html">Demonstration of the CytoPipeline R package suite functionalities</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UCLouvain-CBIO/CytoPipeline/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clean doublet events from flow cytometry data</h1>
      <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/CytoPipeline/blob/main/R/gating.R" class="external-link"><code>R/gating.R</code></a></small>
      <div class="d-none name"><code>singletsGate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>will adjust a polygon gate aimed at cleaning doublet events
from the flowFrame.
The main idea is to use the ratio between the two indicated channel as an
indicator and select only the events for which this ratio is 'not too far'
from the median ratio. More specifically, the computed ratio is ch1/(1+ch2).
However, instead of looking at a constant range of this ratio, as is done in
PeacoQC::removeDoublets(), which leads to a semi-conic gate,
we apply a parallelogram shaped gate, by keeping a constant range of channel
2 intensity, based on the target ratio range at the mid value of channel 1.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">singletsGate</span><span class="op">(</span></span>
<span>  <span class="va">ff</span>,</span>
<span>  filterId <span class="op">=</span> <span class="st">"Singlets"</span>,</span>
<span>  channel1 <span class="op">=</span> <span class="st">"FSC-A"</span>,</span>
<span>  channel2 <span class="op">=</span> <span class="st">"FSC-H"</span>,</span>
<span>  nmad <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ff">ff<a class="anchor" aria-label="anchor" href="#arg-ff"></a></dt>
<dd><p>A flowCore::flowframe that contains flow cytometry data.</p></dd>


<dt id="arg-filterid">filterId<a class="anchor" aria-label="anchor" href="#arg-filterid"></a></dt>
<dd><p>the name for the filter that is returned</p></dd>


<dt id="arg-channel-">channel1<a class="anchor" aria-label="anchor" href="#arg-channel-"></a></dt>
<dd><p>The first channel that will be used to determine the doublet
events. Default is "FSC-A"</p></dd>


<dt id="arg-channel-">channel2<a class="anchor" aria-label="anchor" href="#arg-channel-"></a></dt>
<dd><p>The second channels that will be used to determine the
doublet events. Default is "FSC-H"</p></dd>


<dt id="arg-nmad">nmad<a class="anchor" aria-label="anchor" href="#arg-nmad"></a></dt>
<dd><p>Bandwidth above the ratio allowed (cells are kept if their ratio
is smaller than the median ratio + nmad times the median absolute deviation
of the ratios). Default is 4.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If set to TRUE, the median ratio and width will be printed.
Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function returns a flowCore::polygonGate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simple example with one single singlets gate filter </span></span></span>
<span class="r-in"><span><span class="co"># FSC-A and FSC-H channels are used by default</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySingletsGate</span> <span class="op">&lt;-</span> <span class="fu">singletsGate</span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, nmad <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selectedSinglets</span> <span class="op">&lt;-</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="va">mySingletsGate</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ff_l</span> <span class="op">&lt;-</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/Subset-methods.html" class="external-link">Subset</a></span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">selectedSinglets</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">linRange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggplotFilterEvents.html">ggplotFilterEvents</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ffPre <span class="op">=</span> <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    ffPost <span class="op">=</span> <span class="va">ff_l</span>,</span></span>
<span class="r-in"><span>    xChannel <span class="op">=</span> <span class="st">"FSC-A"</span>, xLinearRange <span class="op">=</span> <span class="va">linRange</span>,</span></span>
<span class="r-in"><span>    yChannel <span class="op">=</span> <span class="st">"FSC-H"</span>, yLinearRange <span class="op">=</span> <span class="va">linRange</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="singletsGate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># application of two singlets gates one after the other</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">singletsGate1</span> <span class="op">&lt;-</span> <span class="fu">singletsGate</span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, nmad <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">singletsGate2</span> <span class="op">&lt;-</span> <span class="fu">singletsGate</span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                              channel1 <span class="op">=</span> <span class="st">"SSC-A"</span>,</span></span>
<span class="r-in"><span>                              channel2 <span class="op">=</span> <span class="st">"SSC-H"</span>,</span></span>
<span class="r-in"><span>                              filterId <span class="op">=</span> <span class="st">"Singlets2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">singletCombinedGate</span> <span class="op">&lt;-</span> <span class="va">singletsGate1</span> <span class="op">&amp;</span> <span class="va">singletsGate2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selectedSinglets</span> <span class="op">&lt;-</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="va">singletCombinedGate</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ff_l</span> <span class="op">&lt;-</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/Subset-methods.html" class="external-link">Subset</a></span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">selectedSinglets</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggplotFilterEvents.html">ggplotFilterEvents</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ffPre <span class="op">=</span> <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    ffPost <span class="op">=</span> <span class="va">ff_l</span>,</span></span>
<span class="r-in"><span>    xChannel <span class="op">=</span> <span class="st">"FSC-A"</span>, xLinearRange <span class="op">=</span> <span class="va">linRange</span>,</span></span>
<span class="r-in"><span>    yChannel <span class="op">=</span> <span class="st">"FSC-H"</span>, yLinearRange <span class="op">=</span> <span class="va">linRange</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="singletsGate-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggplotFilterEvents.html">ggplotFilterEvents</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ffPre <span class="op">=</span> <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    ffPost <span class="op">=</span> <span class="va">ff_l</span>,</span></span>
<span class="r-in"><span>    xChannel <span class="op">=</span> <span class="st">"SSC-A"</span>, xLinearRange <span class="op">=</span> <span class="va">linRange</span>,</span></span>
<span class="r-in"><span>    yChannel <span class="op">=</span> <span class="st">"SSC-H"</span>, yLinearRange <span class="op">=</span> <span class="va">linRange</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="singletsGate-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Philippe Hauchamps, Laurent Gatto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.9000.</p>
</div>

    </footer></div>





  </body></html>

